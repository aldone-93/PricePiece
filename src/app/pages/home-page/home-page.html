<div class="o-filters">
  <mat-form-field>
    <mat-label>Name</mat-label>
    <input matInput type="text" placeholder="Name..." [formField]="filtersForm.name" />
  </mat-form-field>
  <mat-form-field>
    <mat-select [formField]="filtersForm.expansion" placeholder="Select expansion...">
      @for (option of expansions(); track option.id) {
        <mat-option [value]="option.id">{{ option.name }}</mat-option>
      }
    </mat-select>
  </mat-form-field>
  <mat-form-field>
    <mat-label>Min</mat-label>
    <input matInput type="number" placeholder="Min price..." [formField]="filtersForm.minPrice" />
  </mat-form-field>
  <mat-form-field>
    <mat-label>Max</mat-label>
    <input matInput type="number" placeholder="Max price..." [formField]="filtersForm.maxPrice" />
  </mat-form-field>
  <mat-form-field>
    <mat-label>Delta</mat-label>
    <mat-select [formField]="filtersForm.sort" placeholder="Select delta...">
      <mat-option [value]="'minEuDiff'"> Variazione prezzo minimo</mat-option>
      <mat-option [value]="'minEu'"> Prezzo</mat-option>
    </mat-select>
  </mat-form-field>
</div>
<div class="o-content">
  <h2>Singles Top Movers</h2>
  <div class="o-product-list">
    @for (product of getTopMovers.value(); track product.idProduct) {
      <app-product-card
        [id]="product.idProduct"
        [name]="product.name"
        [diff]="product.minEuDiff"
        [minIta]="product.minIta"
        [minEu]="product.minEu"
        [cardtrader_url]="product.cardtrader_url"
      ></app-product-card>
    }
  </div>

  <h2>Singles Top Losers</h2>
  <div class="o-product-list">
    @for (product of getTopLosers.value(); track product.idProduct) {
      <app-product-card
        [id]="product.idProduct"
        [name]="product.name"
        [diff]="product.minEuDiff"
        [minIta]="product.minIta"
        [minEu]="product.minEu"
        [cardtrader_url]="product.cardtrader_url"
      ></app-product-card>
    }
  </div>

  <h2>Set movers</h2>

  <div class="o-product-list">
    @for (set of getTopMoversSet.value(); track set.expansionName) {
      <div class="m-product-card">
        <h4>{{ set?.expansionName }}</h4>
        <img
          src="https://res.cloudinary.com/dntnvwjka/image/upload/{{ set?.idProduct }}_SMALL.jpg"
          alt="{{ set?.expansionName }}"
        />
        <div class="m-cardInfo a-priceInfo">
          @let sign = set.priceDiffPercent > 0 ? 'positive' : 'negative';
          <p [ngClass]="sign">{{ set.priceDiffPercent | number: '1.0-2' }}%</p>
          <p>total: {{ set.totalPrice | currency }}</p>
        </div>
      </div>
    }
  </div>
  @if (selectedProduct()) {
    <app-single-product-dialog
      id="singleProductDialog"
      popover
      [product]="selectedProduct()"
    ></app-single-product-dialog>
  }
</div>
